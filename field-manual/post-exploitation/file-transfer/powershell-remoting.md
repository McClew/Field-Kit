---
icon: windows
---

# PowerShell Remoting

**PowerShell Remoting** - or **WinRM** - is able to execute scripts or commands on a remote computer using _PowerShell sessions_. Administrators commonly use PowerShell Remoting to manage remote computers in a network, and we can also use it for file transfer operations. By default, enabling PowerShell remoting creates both an HTTP and an HTTPS listener. The listeners run on default ports **TCP/5985** for **HTTP** and **TCP/5986** for **HTTPS**.

To create a PowerShell Remoting session on a remote computer, we will need **administrative access**, **be a member of the Remote Management Users group**, or have explicit permissions for PowerShell Remoting in the session configuration.

```powershell
PS C:\> whoami
htb\administrator

PS C:\> hostname
DC01
```

**Confirm that the WinRM port TCP/59985 is open:** In the below example, we are testing the connection at the _remote_ machine `DATABASE01`.

```powershell
PS C:\> Test-NetConnection -ComputerName DATABASE01 -Port 5985

ComputerName     : DATABASE01
RemoteAddress    : 192.168.1.101
RemotePort       : 5985
InterfaceAlias   : Ethernet0
SourceAddress    : 192.168.1.100
TcpTestSucceeded : True
```

**Create a PowerShell Remoting session:**

```powershell
PS C:\> $Session = New-PSSession -ComputerName DATABASE01
```

**Copy files to remote machine:**

```powershell
PS C:\> Copy-Item -Path C:\winPEASx64.exe -ToSession $Session -Destination C:\Users\Administrator\Desktop\
```

**Copy files from the remote machine:**

```powershell
PS C:\> Copy-Item -Path "C:\Users\Administrator\Desktop\flag.txt" -Destination C:\ -FromSession $Session
```
