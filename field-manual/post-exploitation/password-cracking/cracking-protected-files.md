# Cracking Protected Files

## Cracking Encrypted SSH Keys

Use the Python script **ssh2john.py** to acquire the corresponding hash for an encrypted SSH key, and then use JohnTheRipper to attempt to crack it.

```shell
clue@machine[/]$ ssh2john.py SSH.private > ssh.hash
clue@machine[/]$ john --wordlist=rockyou.txt ssh.hash

Using default input encoding: UTF-8
Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 2 OpenMP threads
Note: This format may emit false positives, so it will keep trying even after
finding a possible candidate.
Press 'q' or Ctrl-C to abort, almost any other key for status
1234         (SSH.private)
1g 0:00:00:00 DONE (2022-02-08 03:03) 16.66g/s 1747Kp/s 1747Kc/s 1747KC/s Knightsing..Babying
Session completed
```

## Cracking Password-Protected Documents

JtR includes a Python script called **office2john.py**, which can be used to extract password hashes from all common Office document formats. These hashes can then be supplied to JtR or Hashcat for offline cracking. The cracking procedure remains consistent with other hash types.

```shell
clue@machine[/]$ office2john.py Protected.docx > protected-docx.hash
clue@machine[/]$ john --wordlist=rockyou.txt protected-docx.hash
clue@machine[/]$ john protected-docx.hash --show

Protected.docx:1234

1 password hash cracked, 0 left
```

## Cracking Protected Archives

The **ZIP** format is often heavily used in Windows environments to compress many files into one file. The process of cracking an encrypted ZIP file is similar to what we have seen already, except for using a different script to extract the hashes.

```shell
clue@machine[/]$ zip2john ZIP.zip > zip.hash
clue@machine[/]$ cat zip.hash 

ZIP.zip/customers.csv:$pkzip2$1*2*2*0*2a*1e*490e7510*0*42*0*2a*490e*409b*ef1e7feb7c1cf701a6ada7132e6a5c6c84c032401536faf7493df0294b0d5afc3464f14ec081cc0e18cb*$/pkzip2$:customers.csv:ZIP.zip::ZIP.zip
```

Once we have extracted the hash, we can use JtR to crack it with the desired password list.

```shell
clue@machine[/]$ john --wordlist=rockyou.txt zip.hash

clue@machine[/]$ john zip.hash --show

ZIP.zip/customers.csv:1234:customers.csv:ZIP.zip::ZIP.zip

1 password hash cracked, 0 left
```
